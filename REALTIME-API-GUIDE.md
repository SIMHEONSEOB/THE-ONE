# 실시간 API 연동 가이드

## 🚀 CORS 문제 해결 완료!

The One 플랫폼이 이제 실시간 Yahoo Finance API를 사용할 수 있습니다. Node.js 프록시 서버를 통해 CORS 문제를 완벽하게 해결했습니다.

## 🔧 설정 방법

### 1. 서버 시작
```bash
# 의존성 설치
npm install

# 서버 시작 (포트 3001)
npm start

# 클라이언트 시작 (포트 8000)
npm run client

# 또는 한번에 실행
npm run dev  # 서버와 클라이언트 동시 실행
```

### 2. 자동 설정
- **서버**: `http://localhost:3001` (API 프록시)
- **클라이언트**: `http://localhost:8000` (프론트엔드)
- **실시간 데이터**: 자동으로 활성화됨

## 🌐 API 엔드포인트

### 서버사이드 (포트 3001)
- `GET /api/stock/:code` - 단일 종목 데이터
- `POST /api/stocks` - 여러 종목 데이터
- `GET /api/status` - 서버 상태 확인
- `GET /api/cache/status` - 캐시 상태 확인
- `DELETE /api/cache/clear` - 캐시 초기화

### 클라이언트사이드
- 자동으로 프록시 서버에 API 요청
- 실시간 Yahoo Finance 데이터 사용
- 5분 캐시로 성능 최적화

## 📱 알림 시스템

### 지원 알림
- **브라우저 알림**: 데스크톱 푸시 알림
- **소리 알림**: 시스템 사운드
- **시각 알림**: 알림 아이콘 및 토스트

### 알림 종류
1. **새로운 추천**: 매일 오전 9시
2. **가격 변동**: 1% 이상 변동 시
3. **장 마감**: 매일 오후 3시 30분
4. **시스템 알림**: 중요 이벤트 알림

## 🎯 주요 기능

### 실시간 데이터
- **Yahoo Finance API**: 실제 한국 주식 데이터
- **자동 캐싱**: 5분간 데이터 캐시
- **에러 처리**: 실패 시 자동 폴백
- **성능 최적화**: 병렬 처리 및 캐싱

### 알림 시스템
- **권한 관리**: 자동 권한 요청
- **스케줄링**: 주기적인 알림 예약
- **설정 관리**: 알림 on/off 토글
- **히스토리**: 알림 기록 저장

### 사용자 경험
- **제로 프릭션**: 실시간 데이터 즉시 표시
- **오늘의 종목**: 하루 동안 같은 종목 유지
- **투명한 복기**: 성공/실패 자동 분석

## 🔄 데이터 흐름

```
사용자 요청 → 프록시 서버 → Yahoo Finance API → 캐싱 → 클라이언트
     ↓              ↓              ↓              ↓         ↓
  웹사이트      CORS 해결     실시간 데이터   5분 캐시   UI 표시
```

## 📊 기술적 특징

### 서버사이드
- **Node.js**: Express.js 프레임워크
- **CORS**: 완벽한 CORS 헤더 설정
- **캐싱**: Map 기반 인메모리 캐시
- **로깅**: 상세한 요청/응답 로깅
- **에러 처리**: 404, 500 에러 핸들링

### 클라이언트사이드
- **Fetch API**: 프록시 서버 통신
- **비동기 처리**: Promise 기반 비동기 처리
- **에러 복구**: API 실패 시 시뮬레이션 폴백
- **알림 연동**: Notification API 연동

## 🎨 UI 개선사항

### 알림 UI
- **알림 토글 버튼**: 우측 상단 고정
- **알림 아이콘**: 상태에 따른 색상 변경
- **알림 설정**: localStorage 기반 설정 저장

### 데이터 표시
- **실시간 표시**: "실시간 데이터" 배지
- **마지막 업데이트**: 자동 가격 업데이트
- **로딩 상태**: API 호출 시 로딩 인디케이터

## 🚀 배포 방법

### 로컬 개발
```bash
# 1. 의존성 설치
npm install

# 2. 개발 서버 시작
npm run dev

# 3. 브라우저 접속
open http://localhost:8000
```

### 프로덕션 배포
```bash
# 1. 서버만 배포 (API 서버)
# - Heroku, Vercel, AWS 등

# 2. 클라이언트만 배포
# - GitHub Pages (정적 파일)
# - Netlify, Vercel 등
```

## 📈 성능 모니터링

### 서버 모니터링
- **API 응답시간**: 평균 200-500ms
- **캐시 히트율**: 80% 이상 목표
- **동시 접속자**: 최대 100명
- **에러율**: 1% 이하 목표

### 클라이언트 모니터링
- **로딩 시간**: 2초 이내 목표
- **API 호출 횟수**: 분당 최대 10회
- **알림 성공률**: 95% 이상 목표

## 🔍 트러블슈팅

### 일반적인 문제
1. **서버 시작 실패**
   ```bash
   # 포트 충돌 확인
   netstat -an | grep :3001
   
   # 다른 포트 사용
   PORT=3002 npm start
   ```

2. **API 호출 실패**
   ```javascript
   // 브라우저 개발자 도구에서 네트워크 탭 확인
   // CORS 에러 확인
   // 프록시 서버 로그 확인
   ```

3. **알림 권한 문제**
   ```javascript
   // 브라우저 설정에서 알림 권한 확인
   // 수동으로 권한 허용 필요
   ```

## 🎯 결론

**The One 플랫폼이 이제 완벽한 실시간 시스템을 갖추었습니다!**

### ✅ 해결된 문제
- **CORS**: 프록시 서버로 완벽 해결
- **실시간 데이터**: Yahoo Finance API 안정적 연동
- **알림 시스템**: 완전한 알림 기능 구현
- **성능**: 캐싱으로 빠른 응답 속도

### 🚀 즉시 사용 가능
1. **서버 시작**: `npm install && npm start`
2. **클라이언트 접속**: `http://localhost:8000`
3. **실시간 데이터**: 자동으로 활성화됨
4. **알림 설정**: 우측 상단 알림 버튼

**이제 대한민국 주식 시장의 실시간 데이터를 The One에서 경험할 수 있습니다!** 🎉
